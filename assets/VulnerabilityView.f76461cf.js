import{f as j,g as y,k as N,L as w,M as D,d as P,h as a,o as f,i as r,a as n,t as _,u as c,G as $,H as Y,c as g,b as L,F as I}from"./index.2a01bdce.js";import{_ as b,b as K,D as Q,E as W,a as X,F as Z,G as x}from"./auth.75b214dc.js";import{_ as ee,a as oe,c as re,b as le}from"./SectionTitleLineWithButton.6f9ec719.js";import{_ as A,a as ae}from"./CardBoxModal.747049bb.js";import{_ as u,a as ie}from"./CardBox.bca85cc1.js";import{_ as v}from"./FormField.75048a21.js";import{_ as C}from"./BaseButtons.19f47afb.js";import"./component.317f724c.js";import{u as F}from"./vulnerabilitycategory.f4bc8555.js";import{u as H}from"./vulnerability.3e96a3e0.js";import"./api.5a77c80b.js";const te={class:"pt-8"},ne={class:"pt-8"},se=n("p",null," Ao excluir um item, suas depend\xEAncias tamb\xE9m ser\xE3o exclu\xEDdas automaticamente. ",-1),ue={class:"pt-8"},de=n("b",null,"verifique se a mesma j\xE1 existe",-1),me={class:"lg:w-1 whitespace-nowrap"},fe={class:"p-3 lg:px-6 border-t border-gray-100 dark:border-slate-800"},ce={async mounted(){this.FETCH_VULNERABILITY_CATEGORIES(),this.FETCH_VULNERABILITIES()},methods:{...j(F,["FETCH_VULNERABILITY_CATEGORY","FETCH_VULNERABILITY_CATEGORIES","DELETE_VULNERABILITY_CATEGORY","UPDATE_VULNERABILITY_CATEGORY"]),...j(H,["FETCH_VULNERABILITIES","FETCH_VULNERABILITY","DELETE_VULNERABILITY","UPDATE_VULNERABILITY","RESET_ERRORS"])},data(){return{columns:[{name:"description",title:"Descri\xE7\xE3o"},{name:"beneficiaries",title:"Benefici\xE1rios"}]}}},Ae=Object.assign(ce,{__name:"VulnerabilityView",setup(pe){const T=F(),s=H(),i=y(()=>s.errors);s.$reset(),T.$reset();const U=y(()=>s.vulnerabilities),R=N(5),E=N(0);w(U,()=>{E.value=0});const O=y(()=>{const l=U.value;if(!Array.isArray(l))return[];const o=R.value*E.value,e=o+R.value;return l.slice(o,e)}),k=y(()=>Math.ceil(U.value.length/R.value)),G=y(()=>E.value+1),M=y(()=>{const l=[];for(let o=0;o<k.value;o++)l.push(o);return l}),S=l=>{s.FETCH_VULNERABILITY(l)},h=()=>{s.DELETE_VULNERABILITY(s.selectedVulnerability.id)},d=D({info:!1,new:!1,edit:!1,delete:!1}),m=l=>{d[l]=!d[l],s.RESET_ERRORS()};w(()=>s.selectedVulnerability,l=>{Object.assign(t,{...B,...l})});const B={description:"",beneficiaries:"",program_or_project_to_offer:"",category_id:null},t=D({...B}),q=async()=>{const{description:l,beneficiaries:o,program_or_project_to_offer:e,category_id:p}=t;await s.UPDATE_VULNERABILITY(s.selectedVulnerability.id,l,o,e,p)&&m("edit")},z=async(l,o,e,p)=>{await s.CREATE_VULNERABILITY(l,o,e,p)&&m("new")},J=(l,o)=>{const e=l.find(p=>p.id===o);return e?e.description:null};return(l,o)=>(f(),P(ee,null,{default:a(()=>[r(le,null,{default:a(()=>[r(A,{modelValue:d.info,"onUpdate:modelValue":o[0]||(o[0]=e=>d.info=e),title:"Dados da Vulnerabilidade"},{default:a(()=>[n("p",null,"Descri\xE7\xE3o: "+_(t.description),1),n("p",null,"Benefici\xE1rios: "+_(t.beneficiaries),1),n("p",null,"Produto ou Servi\xE7o: "+_(t.program_or_project_to_offer),1),n("p",null," Categoria de Vulnerabilidade: "+_(J(c(T).vulnerabilityCategories,t.category_id)),1)]),_:1},8,["modelValue"]),r(A,{modelValue:d.new,"onUpdate:modelValue":o[6]||(o[6]=e=>d.new=e),title:"Adicionar Nova Vulnerabilidade",button:l.info,"is-form":"",onSubmit:o[7]||(o[7]=$(e=>z(l.description,l.beneficiaries,l.program_or_project_to_offer,l.category_id),["prevent"]))},{footer:a(()=>[n("div",te,[r(C,null,{default:a(()=>[r(u,{label:"Confirmar",color:"info",type:"submit"}),r(u,{label:"Cancelar",color:"info",outline:"",onClick:o[5]||(o[5]=e=>m("new"))})]),_:1})])]),default:a(()=>[r(v,{label:"Descri\xE7\xE3o",help:i.value.description,error:i.value.description},{default:a(()=>[r(b,{modelValue:l.description,"onUpdate:modelValue":o[1]||(o[1]=e=>l.description=e),name:l.description,error:i.value.description},null,8,["modelValue","name","error"])]),_:1},8,["help","error"]),r(v,{label:"Benefici\xE1rios",help:i.value.beneficiaries,error:i.value.beneficiaries},{default:a(()=>[r(b,{modelValue:l.beneficiaries,"onUpdate:modelValue":o[2]||(o[2]=e=>l.beneficiaries=e),name:l.beneficiaries,error:i.value.beneficiaries},null,8,["modelValue","name","error"])]),_:1},8,["help","error"]),r(v,{label:"Produto ou Servi\xE7o do Projeto",help:i.value.program_or_project_to_offer,error:i.value.program_or_project_to_offer},{default:a(()=>[r(b,{modelValue:l.program_or_project_to_offer,"onUpdate:modelValue":o[3]||(o[3]=e=>l.program_or_project_to_offer=e),name:l.program_or_project_to_offer,":error":i.value.program_or_project_to_offer},null,8,["modelValue","name",":error"])]),_:1},8,["help","error"]),r(v,{label:"Selecione a Categoria da Vulnerabilidade",help:i.value.category_id,error:i.value.category_id},{default:a(()=>[r(b,{modelValue:l.category_id,"onUpdate:modelValue":o[4]||(o[4]=e=>l.category_id=e),name:"category_id",options:c(T).vulnerabilityCategories,error:i.value.category_id},null,8,["modelValue","options","error"])]),_:1},8,["help","error"])]),_:1},8,["modelValue","button"]),r(A,{modelValue:d.edit,"onUpdate:modelValue":o[13]||(o[13]=e=>d.edit=e),title:"Editar Vulnerabilidade",button:"warning","is-form":"",onSubmit:o[14]||(o[14]=$(e=>q(),["prevent"]))},{footer:a(()=>[n("div",ne,[r(C,null,{default:a(()=>[r(u,{label:"Confirmar",color:"warning",type:"submit"}),r(u,{label:"Cancelar",color:"warning",outline:"",onClick:o[12]||(o[12]=e=>m("edit"))})]),_:1})])]),default:a(()=>[r(v,{label:"Descri\xE7\xE3o",help:i.value.description,error:i.value.description},{default:a(()=>[r(b,{modelValue:t.description,"onUpdate:modelValue":o[8]||(o[8]=e=>t.description=e),name:t.description,error:i.value.description},null,8,["modelValue","name","error"])]),_:1},8,["help","error"]),r(v,{label:"Benefici\xE1rios",help:i.value.beneficiaries,error:i.value.beneficiaries},{default:a(()=>[r(b,{modelValue:t.beneficiaries,"onUpdate:modelValue":o[9]||(o[9]=e=>t.beneficiaries=e),name:t.beneficiaries,error:i.value.beneficiaries},null,8,["modelValue","name","error"])]),_:1},8,["help","error"]),r(v,{label:"Produto ou Servi\xE7o do Projeto",help:i.value.program_or_project_to_offer,error:i.value.program_or_project_to_offer},{default:a(()=>[r(b,{modelValue:t.program_or_project_to_offer,"onUpdate:modelValue":o[10]||(o[10]=e=>t.program_or_project_to_offer=e),name:t.program_or_project_to_offer,error:i.value.program_or_project_to_offer},null,8,["modelValue","name","error"])]),_:1},8,["help","error"]),r(v,{label:"Selecione a Categoria da Vulnerabilidade",help:i.value.category_id,error:i.value.category_id},{default:a(()=>[r(b,{modelValue:t.category_id,"onUpdate:modelValue":o[11]||(o[11]=e=>t.category_id=e),name:"form.category_id",options:c(T).vulnerabilityCategories,error:i.value.category_id},null,8,["modelValue","options","error"])]),_:1},8,["help","error"])]),_:1},8,["modelValue"]),r(A,{modelValue:d.delete,"onUpdate:modelValue":o[17]||(o[17]=e=>d.delete=e),isForm:"",onSubmit:o[18]||(o[18]=$(e=>h(),["prevent"])),title:"Voc\xEA realmente quer excluir este item?",button:"danger"},{footer:a(()=>[n("div",ue,[r(C,null,{default:a(()=>[r(u,{label:"Confirmar",color:"danger",type:"submit",onClick:o[15]||(o[15]=e=>m("delete"))}),r(u,{label:"Cancelar",color:"danger",outline:"",onClick:o[16]||(o[16]=e=>m("delete"))})]),_:1})])]),default:a(()=>[se]),_:1},8,["modelValue"]),r(oe,{icon:c(K),title:"Vulnerabilidades",main:""},{default:a(()=>[r(u,{icon:c(Q),label:"Nova Vulnerabilidade",color:"contrast","rounded-full":"",small:"",onClick:o[19]||(o[19]=e=>m("new"))},null,8,["icon"])]),_:1},8,["icon"]),r(ae,{color:"info",icon:c(W)},{default:a(()=>[Y(" Antes de cadastrar uma nova Vulnerabilidade, "),de,Y(". ")]),_:1},8,["icon"]),r(ie,{class:"mb-6","has-table":""},{default:a(()=>[n("table",null,[n("thead",null,[n("tr",null,[(f(!0),g(I,null,L(l.columns,e=>(f(),g("th",{key:e},_(e.title),1))),128))])]),n("tbody",null,[(f(!0),g(I,null,L(O.value,(e,p)=>(f(),g("tr",{key:p},[(f(!0),g(I,null,L(l.columns,V=>(f(),g("td",{key:V},_(e[V.name]),1))),128)),n("td",me,[r(C,{type:"justify-start lg:justify-end","no-wrap":""},{default:a(()=>[r(u,{color:"info",icon:c(X),small:"",onClick:V=>(m("info"),S(e.id))},null,8,["icon","onClick"]),r(u,{color:"warning",icon:c(Z),small:"",onClick:V=>(m("edit"),S(e.id))},null,8,["icon","onClick"]),r(u,{color:"danger",icon:c(x),small:"",onClick:V=>(m("delete"),S(e.id))},null,8,["icon","onClick"])]),_:2},1024)])]))),128))])]),n("div",fe,[r(re,null,{default:a(()=>[r(C,null,{default:a(()=>[(f(!0),g(I,null,L(M.value,e=>(f(),P(u,{key:e,active:e===E.value,label:e+1,color:e===E.value?"lightDark":"whiteDark",small:"",onClick:p=>E.value=e},null,8,["active","label","color","onClick"]))),128))]),_:1}),n("small",null,"P\xE1gina "+_(G.value)+" de "+_(k.value),1)]),_:1})])]),_:1})]),_:1})]),_:1}))}});export{Ae as default};
