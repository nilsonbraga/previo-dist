import{m as le,f as U,g as O,k as N,L as F,M as z,c as I,i as t,h as o,G as y,F as S,o as f,a as i,t as _,u as s,H as J,b as A,d as ne}from"./index.2a01bdce.js";import{_ as p,b as te,D as oe,E as ie,a as ae,F as se,G as de}from"./auth.75b214dc.js";import{_ as re,b as ue,a as me,c as pe}from"./SectionTitleLineWithButton.6f9ec719.js";import{_ as M,a as ce}from"./CardBoxModal.747049bb.js";import{u as R}from"./component.317f724c.js";import{_ as D}from"./BaseButtons.19f47afb.js";import{C as fe,_ as d,a as H}from"./CardBox.bca85cc1.js";import{_ as E}from"./FormField.75048a21.js";import{u as K}from"./dimension.cdad6a00.js";import{u as Q}from"./initiative.3f4a173b.js";import"./api.5a77c80b.js";const ve={class:"pt-8"},Ie={class:"pt-8"},Ee=i("p",null,"Ao excluir um item, suas depend\xEAncias tamb\xE9m ser\xE3o exclu\xEDdas automaticamente.",-1),Te={class:"pt-8"},Ve=i("b",null,"verifique se a mesma j\xE1 existe",-1),Ce={class:"flex"},be={class:"flex"},Ne=i("th",null,null,-1),Se={class:"lg:w-1 whitespace-nowrap"},_e={class:"p-3 lg:px-6 border-t border-gray-100 dark:border-slate-800"},De={props:{clearMethod:{type:Function}},computed:{...le(R,{components:"components"})},async mounted(){this.FETCH_INITIATIVES(),this.FETCH_COMPONENTS(),this.FETCH_DIMENSIONS()},methods:{...U(R,["FETCH_COMPONENT","FETCH_COMPONENTS","DELETE_COMPONENT","UPDATE_COMPONENT"]),...U(K,["FETCH_DIMENSION","FETCH_DIMENSIONS","DELETE_DIMENSION","UPDATE_DIMENSION","FILTER_DIMENSIONS"]),...U(Q,["FETCH_INITIATIVE","FETCH_INITIATIVES","DELETE_INITIATIVE","UPDATE_INITIATIVE","FILTER_INITIATIVES","RESET_ERRORS"])},data(){return{columns:[{name:"title",title:"T\xEDtulo"},{name:"description",title:"Descri\xE7\xE3o"}]}},components:{CardBoxComponentFooter:fe}},Re=Object.assign(De,{__name:"InitiativeView",setup(ge){const V=R(),T=K(),a=Q(),c=O(()=>a.errors);V.$reset(),T.$reset(),a.$reset();const g=N([]),L=l=>{T.FILTER_DIMENSIONS(l)},$=l=>{a.FILTER_INITIATIVES(l)};F(()=>a.filteredInitiatives,()=>{const l=a.filteredInitiatives;g.value=l,v.value=0,j()});const k=N(5),v=N(0),j=()=>{const l=k.value*v.value,e=l+k.value;B.value=g.value.slice(l,e)};F([g,k,v],j);const w=N("");F(w,()=>{v.value=0});const B=N([]),q=O(()=>Math.ceil(g.value.length/k.value)),W=O(()=>v.value+1),X=O(()=>{const l=[];for(let e=0;e<q.value;e++)l.push(e);return l}),Y=l=>{V.FETCH_COMPONENT(l)},Z=l=>{T.FETCH_DIMENSION(l)},P=l=>{a.FETCH_INITIATIVE(l)},h=()=>{a.DELETE_INITIATIVE(a.selectedInitiative.id),$(a.selectedInitiative.dimension_id)},r=z({info:!1,new:!1,edit:!1,delete:!1}),u=l=>{r[l]=!r[l],a.RESET_ERRORS()};F(()=>a.selectedInitiative,l=>{Object.assign(m,{...G,...l})});const G={title:"",description:""},m=z({...G}),x=async()=>{const{title:l,description:e}=m;if(await a.UPDATE_INITIATIVE(a.selectedInitiative.id,l,e)){u("edit");const C=a.selectedInitiative.dimension_id;$(C)}},ee=async(l,e,n)=>{await a.CREATE_INITIATIVE(l,e,n)&&(u("new"),$(n))};return(l,e)=>(f(),I(S,null,[t(M,{modelValue:r.info,"onUpdate:modelValue":e[0]||(e[0]=n=>r.info=n),title:m.title},{default:o(()=>[i("p",null,_(m.description),1)]),_:1},8,["modelValue","title"]),t(M,{modelValue:r.new,"onUpdate:modelValue":e[7]||(e[7]=n=>r.new=n),title:"Adicionar Nova Iniciativa",button:l.info,"is-form":"",onSubmit:e[8]||(e[8]=y(n=>ee(l.title,l.description,l.dimension_id),["prevent"]))},{footer:o(()=>[i("div",ve,[t(D,null,{default:o(()=>[t(d,{label:"Confirmar",color:"info",type:"submit"}),t(d,{label:"Cancelar",color:"info",outline:"",onClick:e[6]||(e[6]=n=>u("new"))})]),_:1})])]),default:o(()=>[t(E,{label:"Selecione o Componente ao qual deseja vincular"},{default:o(()=>[t(p,{modelValue:l.component_id,"onUpdate:modelValue":e[1]||(e[1]=n=>l.component_id=n),name:"component_id",options:s(V).components,onChange:e[2]||(e[2]=n=>L(l.component_id))},null,8,["modelValue","options"])]),_:1}),t(E,{label:"Selecione a Dimens\xE3o a qual deseja vincular",help:c.value.dimension_id,error:c.value.dimension_id},{default:o(()=>[t(p,{modelValue:l.dimension_id,"onUpdate:modelValue":e[3]||(e[3]=n=>l.dimension_id=n),name:l.dimension_id,options:s(T).filteredDimensions,error:c.value.dimension_id},null,8,["modelValue","name","options","error"])]),_:1},8,["help","error"]),t(E,{label:"T\xEDtulo",help:c.value.title,error:c.value.title},{default:o(()=>[t(p,{modelValue:l.title,"onUpdate:modelValue":e[4]||(e[4]=n=>l.title=n),name:l.title,error:c.value.title},null,8,["modelValue","name","error"])]),_:1},8,["help","error"]),t(E,{label:"Descri\xE7\xE3o",help:c.value.description,error:c.value.description},{default:o(()=>[t(p,{modelValue:l.description,"onUpdate:modelValue":e[5]||(e[5]=n=>l.description=n),name:l.description,error:c.value.description},null,8,["modelValue","name","error"])]),_:1},8,["help","error"])]),_:1},8,["modelValue","button"]),t(M,{modelValue:r.edit,"onUpdate:modelValue":e[12]||(e[12]=n=>r.edit=n),title:"Editar Iniciativa",button:"warning","is-form":"",onSubmit:e[13]||(e[13]=y(n=>x(),["prevent"]))},{footer:o(()=>[i("div",Ie,[t(D,null,{default:o(()=>[t(d,{label:"Confirmar",color:"warning",type:"submit"}),t(d,{label:"Cancelar",color:"warning",outline:"",onClick:e[11]||(e[11]=n=>u("edit"))})]),_:1})])]),default:o(()=>[t(E,{label:"T\xEDtulo"},{default:o(()=>[t(p,{modelValue:m.title,"onUpdate:modelValue":e[9]||(e[9]=n=>m.title=n),name:m.title},null,8,["modelValue","name"])]),_:1}),t(E,{label:"Descri\xE7\xE3o"},{default:o(()=>[t(p,{modelValue:m.description,"onUpdate:modelValue":e[10]||(e[10]=n=>m.description=n),name:m.description},null,8,["modelValue","name"])]),_:1})]),_:1},8,["modelValue"]),t(M,{modelValue:r.delete,"onUpdate:modelValue":e[16]||(e[16]=n=>r.delete=n),isForm:"",onSubmit:e[17]||(e[17]=y(n=>h(),["prevent"])),title:"Voc\xEA realmente quer excluir este item?",button:"danger"},{footer:o(()=>[i("div",Te,[t(D,null,{default:o(()=>[t(d,{label:"Confirmar",color:"danger",type:"submit",onClick:e[14]||(e[14]=n=>u("delete"))}),t(d,{label:"Cancelar",color:"danger",outline:"",onClick:e[15]||(e[15]=n=>u("delete"))})]),_:1})])]),default:o(()=>[Ee]),_:1},8,["modelValue"]),t(re,null,{default:o(()=>[t(ue,null,{default:o(()=>[t(me,{icon:s(te),title:"Iniciativas",main:""},{default:o(()=>[t(d,{icon:s(oe),label:"Nova Iniciativa",color:"contrast","rounded-full":"",small:"",onClick:e[18]||(e[18]=n=>u("new"))},null,8,["icon"])]),_:1},8,["icon"]),t(ce,{color:"info",icon:s(ie)},{default:o(()=>[J(" Antes de cadastrar uma nova iniciativa, "),Ve,J(". ")]),_:1},8,["icon"]),t(H,{class:"mb-6"},{default:o(()=>[t(E,{label:"Selecione o Componente"},{default:o(()=>[i("div",Ce,[t(p,{class:"basis-1/4 mr-4",modelValue:l.component,"onUpdate:modelValue":e[19]||(e[19]=n=>l.component=n),name:w.value,options:s(V).components,onChange:e[20]||(e[20]=n=>{Y(l.component),L(l.component)})},null,8,["modelValue","name","options"]),t(p,{class:"basis-3/4",disabled:"",value:s(V).selectedComponent.id,placeholder:s(V).selectedComponent.description,modelValue:l.selectedComponent,"onUpdate:modelValue":e[21]||(e[21]=n=>l.selectedComponent=n)},null,8,["value","placeholder","modelValue"])])]),_:1})]),_:1}),t(H,{class:"mb-6"},{default:o(()=>[t(E,{label:"Selecione a Dimens\xE3o"},{default:o(()=>[i("div",be,[t(p,{class:"basis-1/4 mr-4",modelValue:l.dimension,"onUpdate:modelValue":e[22]||(e[22]=n=>l.dimension=n),name:w.value,options:s(T).filteredDimensions,onChange:e[23]||(e[23]=n=>{Z(l.dimension),$(l.dimension)})},null,8,["modelValue","name","options"]),t(p,{class:"basis-3/4",disabled:"",value:s(T).selectedDimension.id,placeholder:s(T).selectedDimension.description,modelValue:l.selectedDimension,"onUpdate:modelValue":e[24]||(e[24]=n=>l.selectedDimension=n)},null,8,["value","placeholder","modelValue"])])]),_:1})]),_:1}),t(H,{class:"mb-6","has-table":""},{default:o(()=>[i("table",null,[i("thead",null,[i("tr",null,[(f(!0),I(S,null,A(l.columns,n=>(f(),I("th",{key:n},_(n.title),1))),128)),Ne])]),i("tbody",null,[(f(!0),I(S,null,A(B.value,(n,C)=>(f(),I("tr",{key:C},[(f(!0),I(S,null,A(l.columns,b=>(f(),I("td",{key:b},_(n[b.name]),1))),128)),i("td",Se,[t(D,{type:"justify-start lg:justify-end","no-wrap":""},{default:o(()=>[t(d,{color:"info",icon:s(ae),small:"",onClick:b=>(P(n.id),u("info"))},null,8,["icon","onClick"]),t(d,{color:"warning",icon:s(se),small:"",onClick:b=>(P(n.id),u("edit"))},null,8,["icon","onClick"]),t(d,{color:"danger",icon:s(de),small:"",onClick:b=>(P(n.id),u("delete"))},null,8,["icon","onClick"])]),_:2},1024)])]))),128))])]),i("div",_e,[t(pe,null,{default:o(()=>[t(D,null,{default:o(()=>[(f(!0),I(S,null,A(X.value,n=>(f(),ne(d,{key:n,active:n===v.value,label:n+1,color:n===v.value?"lightDark":"whiteDark",small:"",onClick:C=>v.value=n},null,8,["active","label","color","onClick"]))),128))]),_:1}),i("small",null,"P\xE1gina "+_(W.value)+" de "+_(q.value),1)]),_:1})])]),_:1})]),_:1})]),_:1})],64))}});export{Re as default};
