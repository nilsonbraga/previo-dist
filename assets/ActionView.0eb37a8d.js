import{f as A,g as j,k as O,L as U,M as Q,c as C,i as t,h as n,G as L,F as _,o as v,a as s,t as P,u as i,H as W,b as R,d as de}from"./index.2a01bdce.js";import{_ as a,b as ue,D as me,E as pe,a as fe,F as ce,G as ve}from"./auth.75b214dc.js";import{_ as Ee,b as Te,a as Ce,c as Ie}from"./SectionTitleLineWithButton.6f9ec719.js";import{_ as k,a as Ve}from"./CardBoxModal.747049bb.js";import{u as X}from"./component.317f724c.js";import{_ as D}from"./BaseButtons.19f47afb.js";import{C as be,_ as m,a as F}from"./CardBox.bca85cc1.js";import{_ as d}from"./FormField.75048a21.js";import{u as Y}from"./dimension.cdad6a00.js";import{u as Z}from"./initiative.3f4a173b.js";import{u as h}from"./project.b6eecae0.js";import{u as x}from"./action.6af36420.js";import"./api.5a77c80b.js";const Se={class:"pt-8"},Ne={class:"pt-8"},Ae=s("p",null,"Ao excluir um item, suas depend\xEAncias tamb\xE9m ser\xE3o exclu\xEDdas automaticamente.",-1),Oe={class:"pt-8"},_e=s("b",null,"verifique se a mesma j\xE1 existe",-1),Pe={class:"flex"},De={class:"flex"},Fe={class:"flex"},$e={class:"flex"},ge=s("th",null,null,-1),je={class:"lg:w-1 whitespace-nowrap"},Ue={class:"p-3 lg:px-6 border-t border-gray-100 dark:border-slate-800"},Re={props:{clearMethod:{type:Function}},async mounted(){this.FETCH_INITIATIVES(),this.FETCH_COMPONENTS(),this.FETCH_DIMENSIONS(),this.FETCH_PROJECTS(),this.FETCH_ACTIONS()},methods:{...A(X,["FETCH_COMPONENT","FETCH_COMPONENTS","DELETE_COMPONENT","UPDATE_COMPONENT"]),...A(Y,["FETCH_DIMENSION","FETCH_DIMENSIONS","DELETE_DIMENSION","UPDATE_DIMENSION","FILTER_DIMENSIONS"]),...A(Z,["FETCH_INITIATIVE","FETCH_INITIATIVES","DELETE_INITIATIVE","UPDATE_INITIATIVE","FILTER_INITIATIVES"]),...A(h,["FETCH_PROJECT","FETCH_PROJECTS","DELETE_PROJECT","UPDATE_PROJECT","FILTER_PROJECTS"]),...A(x,["FETCH_ACTION","FETCH_ACTIONS","DELETE_ACTION","UPDATE_ACTION","FILTER_ACTIONS","RESET_ERRORS"])},data(){return{columns:[{name:"title",title:"T\xEDtulo"},{name:"description",title:"Descri\xE7\xE3o"}]}},components:{CardBoxComponentFooter:be}},Xe=Object.assign(Re,{__name:"ActionView",setup(ke){const b=X(),I=Y(),E=Z(),V=h(),u=x(),r=j(()=>u.errors);b.$reset(),I.$reset(),E.$reset(),V.$reset(),u.$reset();const $=O([]),y=e=>{I.FILTER_DIMENSIONS(e)},J=e=>{E.FILTER_INITIATIVES(e)},B=e=>{V.FILTER_PROJECTS(e)},H=e=>{u.FILTER_ACTIONS(e)};U(()=>u.filteredActions,()=>{const e=u.filteredActions;$.value=e,T.value=0,q()});const g=O(5),T=O(0),q=()=>{const e=g.value*T.value,l=e+g.value;G.value=$.value.slice(e,l)};U([$,g,T],q);const S=O("");U(S,()=>{T.value=0});const G=O([]),z=j(()=>Math.ceil($.value.length/g.value)),ee=j(()=>T.value+1),le=j(()=>{const e=[];for(let l=0;l<z.value;l++)e.push(l);return e}),oe=e=>{b.FETCH_COMPONENT(e)},te=e=>{I.FETCH_DIMENSION(e)},ne=e=>{E.FETCH_INITIATIVE(e)},ie=e=>{V.FETCH_PROJECT(e)},M=e=>{u.FETCH_ACTION(e)},se=()=>{u.DELETE_ACTION(u.selectedAction.id)},p=Q({info:!1,new:!1,edit:!1,delete:!1}),f=e=>{p[e]=!p[e],E.RESET_ERRORS()};U(()=>u.selectedAction,e=>{Object.assign(c,{...K,...e})});const K={title:"",description:""},c=Q({...K}),ae=async()=>{const{title:e,description:l}=c;await u.UPDATE_ACTION(u.selectedAction.id,e,l)&&(f("edit"),H(u.selectedAction.project_id))},re=async(e,l,o)=>{await u.CREATE_ACTION(e,l,o)&&(f("new"),H(o))};return(e,l)=>(v(),C(_,null,[t(k,{modelValue:p.info,"onUpdate:modelValue":l[0]||(l[0]=o=>p.info=o),title:c.title},{default:n(()=>[s("p",null,P(c.description),1)]),_:1},8,["modelValue","title"]),t(k,{class:"xl:w-4/20",modelValue:p.new,"onUpdate:modelValue":l[11]||(l[11]=o=>p.new=o),title:"Adicionar Nova A\xE7\xE3o",button:e.info,"is-form":"",onSubmit:l[12]||(l[12]=L(o=>re(e.title,e.description,e.project_id),["prevent"]))},{footer:n(()=>[s("div",Se,[t(D,null,{default:n(()=>[t(m,{label:"Confirmar",color:"info",type:"submit"}),t(m,{label:"Cancelar",color:"info",outline:"",onClick:l[10]||(l[10]=o=>f("new"))})]),_:1})])]),default:n(()=>[t(d,{class:"mb-0"},{default:n(()=>[t(d,{label:"Selecione o Componente",class:"mb-4"},{default:n(()=>[t(a,{modelValue:e.component_id,"onUpdate:modelValue":l[1]||(l[1]=o=>e.component_id=o),name:"component_id",options:i(b).components,onChange:l[2]||(l[2]=o=>y(e.component_id))},null,8,["modelValue","options"])]),_:1}),t(d,{label:"Selecione a Dimens\xE3o"},{default:n(()=>[t(a,{modelValue:e.dimension_id,"onUpdate:modelValue":l[3]||(l[3]=o=>e.dimension_id=o),name:"dimension_id",options:i(I).filteredDimensions,onChange:l[4]||(l[4]=o=>J(e.dimension_id))},null,8,["modelValue","options"])]),_:1})]),_:1}),t(d,{class:"mb-0"},{default:n(()=>[t(d,{label:"Selecione a Iniciativa"},{default:n(()=>[t(a,{modelValue:e.initiative_id,"onUpdate:modelValue":l[5]||(l[5]=o=>e.initiative_id=o),name:"initiative_id",options:i(E).filteredInitiatives,onChange:l[6]||(l[6]=o=>B(e.initiative_id))},null,8,["modelValue","options"])]),_:1}),t(d,{label:"Selecione o Projeto",help:r.value.project_id,error:r.value.project_id},{default:n(()=>[t(a,{modelValue:e.project_id,"onUpdate:modelValue":l[7]||(l[7]=o=>e.project_id=o),name:"project_id",options:i(V).filteredProjects,error:r.value.project_id},null,8,["modelValue","options","error"])]),_:1},8,["help","error"])]),_:1}),t(d,{label:"T\xEDtulo",help:r.value.title,error:r.value.title},{default:n(()=>[t(a,{modelValue:e.title,"onUpdate:modelValue":l[8]||(l[8]=o=>e.title=o),name:e.title,error:r.value.title},null,8,["modelValue","name","error"])]),_:1},8,["help","error"]),t(d,{label:"Descri\xE7\xE3o",help:r.value.description,error:r.value.description},{default:n(()=>[t(a,{modelValue:e.description,"onUpdate:modelValue":l[9]||(l[9]=o=>e.description=o),name:e.description,error:r.value.description},null,8,["modelValue","name","error"])]),_:1},8,["help","error"])]),_:1},8,["modelValue","button"]),t(k,{modelValue:p.edit,"onUpdate:modelValue":l[16]||(l[16]=o=>p.edit=o),title:"Editar Iniciativa",button:"warning","is-form":"",onSubmit:l[17]||(l[17]=L(o=>ae(),["prevent"]))},{footer:n(()=>[s("div",Ne,[t(D,null,{default:n(()=>[t(m,{label:"Confirmar",color:"warning",type:"submit"}),t(m,{label:"Cancelar",color:"warning",outline:"",onClick:l[15]||(l[15]=o=>f("edit"))})]),_:1})])]),default:n(()=>[t(d,{label:"T\xEDtulo",help:r.value.title,error:r.value.title},{default:n(()=>[t(a,{modelValue:c.title,"onUpdate:modelValue":l[13]||(l[13]=o=>c.title=o),name:c.title,error:r.value.title},null,8,["modelValue","name","error"])]),_:1},8,["help","error"]),t(d,{label:"Descri\xE7\xE3o",help:r.value.description,error:r.value.description},{default:n(()=>[t(a,{modelValue:c.description,"onUpdate:modelValue":l[14]||(l[14]=o=>c.description=o),name:c.description,error:r.value.description},null,8,["modelValue","name","error"])]),_:1},8,["help","error"])]),_:1},8,["modelValue"]),t(k,{modelValue:p.delete,"onUpdate:modelValue":l[20]||(l[20]=o=>p.delete=o),isForm:"",onSubmit:l[21]||(l[21]=L(o=>se(),["prevent"])),title:"Voc\xEA realmente quer excluir este item?",button:"danger"},{footer:n(()=>[s("div",Oe,[t(D,null,{default:n(()=>[t(m,{label:"Confirmar",color:"danger",type:"submit",onClick:l[18]||(l[18]=o=>f("delete"))}),t(m,{label:"Cancelar",color:"danger",outline:"",onClick:l[19]||(l[19]=o=>f("delete"))})]),_:1})])]),default:n(()=>[Ae]),_:1},8,["modelValue"]),t(Ee,null,{default:n(()=>[t(Te,null,{default:n(()=>[t(Ce,{icon:i(ue),title:"A\xE7\xF5es",main:""},{default:n(()=>[t(m,{icon:i(me),label:"Nova A\xE7\xE3o",color:"contrast","rounded-full":"",small:"",onClick:l[22]||(l[22]=o=>f("new"))},null,8,["icon"])]),_:1},8,["icon"]),t(Ve,{color:"info",icon:i(pe)},{default:n(()=>[W(" Antes de cadastrar uma nova a\xE7\xE3o, "),_e,W(". ")]),_:1},8,["icon"]),t(F,{class:"mb-6"},{default:n(()=>[t(d,{label:"Selecione o Componente"},{default:n(()=>[s("div",Pe,[t(a,{class:"basis-1/4 mr-4",modelValue:e.component,"onUpdate:modelValue":l[23]||(l[23]=o=>e.component=o),name:S.value,options:i(b).components,onChange:l[24]||(l[24]=o=>{oe(e.component),y(e.component)})},null,8,["modelValue","name","options"]),t(a,{class:"basis-3/4",disabled:"",value:i(b).selectedComponent.id,placeholder:i(b).selectedComponent.description,modelValue:e.selectedComponent,"onUpdate:modelValue":l[25]||(l[25]=o=>e.selectedComponent=o)},null,8,["value","placeholder","modelValue"])])]),_:1})]),_:1}),t(F,{class:"mb-6"},{default:n(()=>[t(d,{label:"Selecione a Dimens\xE3o"},{default:n(()=>[s("div",De,[t(a,{class:"basis-1/4 mr-4",modelValue:e.dimension,"onUpdate:modelValue":l[26]||(l[26]=o=>e.dimension=o),name:S.value,options:i(I).filteredDimensions,onChange:l[27]||(l[27]=o=>{te(e.dimension),J(e.dimension)})},null,8,["modelValue","name","options"]),t(a,{class:"basis-3/4",disabled:"",value:i(I).selectedDimension.id,placeholder:i(I).selectedDimension.description,modelValue:e.selectedDimension,"onUpdate:modelValue":l[28]||(l[28]=o=>e.selectedDimension=o)},null,8,["value","placeholder","modelValue"])])]),_:1})]),_:1}),t(F,{class:"mb-6"},{default:n(()=>[t(d,{label:"Selecione a Iniciativa"},{default:n(()=>[s("div",Fe,[t(a,{class:"basis-1/4 mr-4",modelValue:e.initiative,"onUpdate:modelValue":l[29]||(l[29]=o=>e.initiative=o),name:S.value,options:i(E).filteredInitiatives,onChange:l[30]||(l[30]=o=>{ne(e.initiative),B(e.initiative)})},null,8,["modelValue","name","options"]),t(a,{class:"basis-3/4",disabled:"",value:i(E).selectedInitiative.id,placeholder:i(E).selectedInitiative.description,modelValue:e.selectedInitiative,"onUpdate:modelValue":l[31]||(l[31]=o=>e.selectedInitiative=o)},null,8,["value","placeholder","modelValue"])])]),_:1})]),_:1}),t(F,{class:"mb-6"},{default:n(()=>[t(d,{label:"Selecione o Projeto"},{default:n(()=>[s("div",$e,[t(a,{class:"basis-1/4 mr-4",modelValue:e.project,"onUpdate:modelValue":l[32]||(l[32]=o=>e.project=o),name:S.value,options:i(V).filteredProjects,onChange:l[33]||(l[33]=o=>{ie(e.project),H(e.project)})},null,8,["modelValue","name","options"]),t(a,{class:"basis-3/4",disabled:"",value:i(V).selectedProject.id,placeholder:i(V).selectedProject.description,modelValue:e.selectedProject,"onUpdate:modelValue":l[34]||(l[34]=o=>e.selectedProject=o)},null,8,["value","placeholder","modelValue"])])]),_:1})]),_:1}),t(F,{class:"mb-6","has-table":""},{default:n(()=>[s("table",null,[s("thead",null,[s("tr",null,[(v(!0),C(_,null,R(e.columns,o=>(v(),C("th",{key:o},P(o.title),1))),128)),ge])]),s("tbody",null,[(v(!0),C(_,null,R(G.value,(o,w)=>(v(),C("tr",{key:w},[(v(!0),C(_,null,R(e.columns,N=>(v(),C("td",{key:N},P(o[N.name]),1))),128)),s("td",je,[t(D,{type:"justify-start lg:justify-end","no-wrap":""},{default:n(()=>[t(m,{color:"info",icon:i(fe),small:"",onClick:N=>(M(o.id),f("info"))},null,8,["icon","onClick"]),t(m,{color:"warning",icon:i(ce),small:"",onClick:N=>(M(o.id),f("edit"))},null,8,["icon","onClick"]),t(m,{color:"danger",icon:i(ve),small:"",onClick:N=>(M(o.id),f("delete"))},null,8,["icon","onClick"])]),_:2},1024)])]))),128))])]),s("div",Ue,[t(Ie,null,{default:n(()=>[t(D,null,{default:n(()=>[(v(!0),C(_,null,R(le.value,o=>(v(),de(m,{key:o,active:o===T.value,label:o+1,color:o===T.value?"lightDark":"whiteDark",small:"",onClick:w=>T.value=o},null,8,["active","label","color","onClick"]))),128))]),_:1}),s("small",null,"P\xE1gina "+P(ee.value)+" de "+P(z.value),1)]),_:1})])]),_:1})]),_:1})]),_:1})],64))}});export{Xe as default};
